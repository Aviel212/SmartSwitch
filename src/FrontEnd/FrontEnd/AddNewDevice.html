<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <link href="styles/w3css.css" rel="stylesheet" />

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>
    <div id="main-div" style="overflow-y:scroll">
        <table id="main-table">
            <tr>
                <td><h3><u>Add New Device:   </u></h3></td>
                <td>
                    <a href="AddNewDevice.html">
                        <i class="fa fa-refresh" aria-hidden="false" style="width:20px"></i>
                    </a>
                </td>

            </tr>
        </table>
        <div id="myPopUp-div">
            <table>
                <tr>
                    <td><p>nickname</p></td>
                    <td><input type="text" id="Nickname"></td>
                </tr>
                <tr>
                    <td><p>priority:</p></td>
                    <td>
                        <input type="radio" name="prio" value="Essential">ess<br>
                        <input type="radio" name="prio" value="NonEssential"> non-ess<br>
                    </td>
                </tr>
            </table>
            <input type="button"  id="answeryes" value="next" onclick="approveContent()" />
            <input type="button"  id="answerno" value="cancel" onclick="cancelPopUp()"  />
        </div>
    </div>
    <script>
        let USER//need to check if user is a global at aviel
        let $myPopUp;
        let $main;
        let notApproved = [];
        let $notifier;

        $(document).ready(function () {
            $main = $("#main-div");
            $main.css("position", "relative");
            $myPopUp = $("#myPopUp-div");

            $myPopUp.css("z-index", "2000");

            $myPopUp.css("width", 100);
            $myPopUp.css("height", 100);
            $main.css("width",300);//need to be discussed
            $main.css("height", 300);
            
            $myPopUp.css({ top: 40, left: 50, position: 'absolute' });
            $myPopUp.hide();

            //getting all available mac addressess and appending them to main div
            drawMacAddress();

            
        });

        function drawMacAddress()
        {
            for (let i = 0; i < USER.plugs.length; i++)
            {
                if (USER.plugs[i].Approved == false)
                {
                    notApproved.add(USER.plugs[i]);
                    insertnotApproved(USER.plugs[i]);
                }

            }

            
        }
        function insertnotApproved(plugg)
        {
            let $currentTR = $("<tr>");
            let $macTD = $("<td>");
            let $buttonsTD = $("<td>");

            let $macText = $("<p>");
            $macText.val("plugg.Mac");//gets the mac address from the current plug
            $macTD.append($macText);

            let $accept = $("<button>");
            let $reject = $("<button>");
            $accept.prop('value', 'accept');
            $reject.prop('value', 'reject');

            $accept.on('click', function () {//my pop up shows up to let user enter nickname and priority
                $myPopUp.css({ top: 40, left: 50, position: 'absolute' });//top and left will need to be discussed
                $myPopUp.show();
                $main.prop("disabled", true);//remmember to cancel at the end
                $myPopUp.prop("disabled", false);
                $notifer = plugg//copying the current chosen mac address 
               


            });


            $reject.on('click', removeFromList);//need to remove from array then on loop do insert not approved
            $buttonsTD.append($accept, $reject);//works?

            $currentTR.append($macTD);
            $currentTR.append($buttonsTD);
        }
        function cancelPopUp()
        {
            $myPopUp.hide();
            $main.prop("disabled", false);

        }
        function approveContent()
        {
            for (let i = 0; i < USER.plugs.length; i++)
            {
                if (USER.plugs[i].Mac == $notifier)
                {
                    USER.plugs[i].Nickname = $("#Nickname").val();//works?
                    USER.plugs[i].Approved = true;
                    USER.plugs[i].Priority = $("input[name='prio']:checked").val()
                }
            }
        }
        //////////////////////////////////////////////////////////////////






        
    </script>
</body>
</html>